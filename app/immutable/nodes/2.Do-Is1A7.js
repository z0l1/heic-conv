import{i as be,p as K,a as Q,_ as ye}from"../chunks/2pIoUwAn.js";import{b as M,t as D}from"../chunks/D5AkK7aD.js";import{A as ne,B as ie,C as Ee,h as re,n as T,q as Z,F as xe,Q as we,p as Ce,m as Te,f as v,H as Ie,r as le,t as j,y as V,K as ke,v as ve,w as ue,x as Ae,a8 as ee,O as ce,a9 as Le,aa as Ne,N as Oe,ab as Re,W as Se,ac as Me,ad as qe,s as se,ae as De,k as He,af as Fe,ag as Pe,I as Ve,ah as Ue,ai as de,R as $e,u as Be,aj as U,X as x,Y as ae,T as We,e as q,a6 as C,a7 as w,a5 as te,a3 as Ye}from"../chunks/DM6kXdZl.js";import{d as Ge,s as Y}from"../chunks/J6omZDSx.js";import{o as Xe}from"../chunks/B_95bkhZ.js";let oe=!1;function ze(){oe||(oe=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{var a;if(!e.defaultPrevented)for(const t of e.target.elements)(a=t.__on_r)==null||a.call(t)})},{capture:!0}))}function Je(e){var a=Ee,t=re;ne(null),ie(null);try{return e()}finally{ne(a),ie(t)}}function _e(e,a,t,r=t){e.addEventListener(a,()=>Je(t));const n=e.__on_r;n?e.__on_r=()=>{n(),r(!0)}:e.__on_r=()=>r(!0),ze()}function Ke(e,a){return a}function Qe(e,a,t,r){for(var n=[],f=a.length,o=0;o<f;o++)Ne(a[o].e,n,!0);var h=f>0&&n.length===0&&t!==null;if(h){var g=t.parentNode;Oe(g),g.append(t),r.clear(),I(e,a[0].prev,a[f-1].next)}Re(n,()=>{for(var b=0;b<f;b++){var i=a[b];h||(r.delete(i.k),I(e,i.prev,i.next)),Se(i.e,!h)}})}function Ze(e,a,t,r,n,f=null){var o=e,h={flags:a,items:new Map,first:null};{var g=e;o=T?Z(xe(g)):g.appendChild(we())}T&&Ce();var b=null,i=!1,m=Me(()=>{var l=t();return He(l)?l:l==null?[]:ce(l)});Te(()=>{var l=v(m),c=l.length;if(i&&c===0)return;i=c===0;let u=!1;if(T){var d=o.data===Ie;d!==(c===0)&&(o=le(),Z(o),j(!1),u=!0)}if(T){for(var _=null,s,p=0;p<c;p++){if(V.nodeType===8&&V.data===ke){o=V,u=!0,j(!1);break}var k=l[p],E=r(k,p);s=pe(V,h,_,null,k,E,p,n,a,t),h.items.set(E,s),_=s}c>0&&Z(le())}T||je(l,h,o,n,a,r,t),f!==null&&(c===0?b?ve(b):b=ue(()=>f(o)):b!==null&&Ae(b,()=>{b=null})),u&&j(!0),v(m)}),T&&(o=V)}function je(e,a,t,r,n,f,o){var h=e.length,g=a.items,b=a.first,i=b,m,l=null,c=[],u=[],d,_,s,p;for(p=0;p<h;p+=1){if(d=e[p],_=f(d,p),s=g.get(_),s===void 0){var k=i?i.e.nodes_start:t;l=pe(k,a,l,l===null?a.first:l.next,d,_,p,r,n,o),g.set(_,l),c=[],u=[],i=l.next;continue}if(ea(s,d,p),s.e.f&ee&&ve(s.e),s!==i){if(m!==void 0&&m.has(s)){if(c.length<u.length){var E=u[0],y;l=E.prev;var O=c[0],R=c[c.length-1];for(y=0;y<c.length;y+=1)fe(c[y],E,t);for(y=0;y<u.length;y+=1)m.delete(u[y]);I(a,O.prev,R.next),I(a,l,O),I(a,R,E),i=E,l=R,p-=1,c=[],u=[]}else m.delete(s),fe(s,i,t),I(a,s.prev,s.next),I(a,s,l===null?a.first:l.next),I(a,l,s),l=s;continue}for(c=[],u=[];i!==null&&i.k!==_;)i.e.f&ee||(m??(m=new Set)).add(i),u.push(i),i=i.next;if(i===null)continue;s=i}c.push(s),l=s,i=s.next}if(i!==null||m!==void 0){for(var A=m===void 0?[]:ce(m);i!==null;)i.e.f&ee||A.push(i),i=i.next;var G=A.length;if(G>0){var X=h===0?t:null;Qe(a,A,X,g)}}re.first=a.first&&a.first.e,re.last=l&&l.e}function ea(e,a,t,r){Le(e.v,a),e.i=t}function pe(e,a,t,r,n,f,o,h,g,b){var i=(g&Fe)!==0,m=(g&Pe)===0,l=i?m?qe(n):se(n):n,c=g&De?se(o):o,u={i:c,v:l,k:f,a:null,e:null,prev:t,next:r};try{return u.e=ue(()=>h(e,l,c,b),T),u.e.prev=t&&t.e,u.e.next=r&&r.e,t===null?a.first=u:(t.next=u,t.e.next=u.e),r!==null&&(r.prev=u,r.e.prev=u.e),u}finally{}}function fe(e,a,t){for(var r=e.next?e.next.e.nodes_start:t,n=a?a.e.nodes_start:t,f=e.e.nodes_start;f!==r;){var o=Ve(f);n.before(f),f=o}}function I(e,a,t){a===null?e.first=t:(a.next=t,a.e.next=t&&t.e),t!==null&&(t.prev=a,t.e.prev=a&&a.e)}function aa(e,a,t=a){_e(e,"change",()=>{t(e.files)}),T&&e.files&&t(e.files),Ue(()=>{e.files=a()})}function he(e,a,t){if(e.multiple)return na(e,a);for(var r of e.options){var n=$(r);if(be(n,a)){r.selected=!0;return}}(!t||a!==void 0)&&(e.selectedIndex=-1)}function ta(e,a){de(()=>{var t=new MutationObserver(()=>{var r=e.__value;he(e,r)});return t.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{t.disconnect()}})}function ra(e,a,t=a){var r=!0;_e(e,"change",n=>{var f=n?"[selected]":":checked",o;if(e.multiple)o=[].map.call(e.querySelectorAll(f),$);else{var h=e.querySelector(f)??e.querySelector("option:not([disabled])");o=h&&$(h)}t(o)}),de(()=>{var n=a();if(he(e,n,r),r&&n===void 0){var f=e.querySelector(":checked");f!==null&&(n=$(f),t(n))}e.__value=n,r=!1}),ta(e)}function na(e,a){for(var t of e.options)t.selected=~a.indexOf($(t))}function $(e){return"__value"in e?e.__value:e.value}const ia=e=>{console.log(e)},la=(e,a)=>{for(const t of v(a)){const r=URL.createObjectURL(t),n=document.createElement("a");n.href=r,n.download=t.name,document.body.appendChild(n),n.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window})),document.body.removeChild(n)}};var sa=D('<li><span class="font-mono"> </span> <span class="font-mono"> </span></li>'),oa=D('<div class="flex flex-row items-center gap-1">converting <div class="max-w-min animate-spin">...</div></div>'),fa=D('<div>finished...</div> <button type="button" class="border bg-slate-300 p-2 px-4">DOWNLOAD FILES</button>',1),va=D("<h1> </h1> <h1> </h1> <!>",1),ua=D('<div class="flex w-full"><div class="flex-1"><ul></ul></div> <div class="flex-1"><div><span>CONVERT HEIC TO</span> <select><option label="PNG"></option><option label="JPEG"></option></select></div> <button type="button" class="border bg-slate-300 p-2 px-4">CONVERT</button> <!></div></div>'),ca=D('<h1 class="text-lg font-bold">SELECT FILES</h1> <input accept=".heic" type="file" multiple> <!>',1);function ma(e,a){$e(a,!0);let t;Xe(async()=>{typeof window<"u"&&(t=(await ye(()=>import("../chunks/sdXlkpFp.js").then(_=>_.h),[],import.meta.url)).default)});let r=U(void 0),n=U("png");Be(()=>{console.log("files changed",v(r))});let f=U(0),o=U(K([])),h=U(!1),g=Ye(()=>v(o).length!==v(f));const b=async()=>{if(q(f,0),q(o,K([])),!v(r))return;const d=[];for(const _ of v(r))_.name.toLowerCase().endsWith(".heic")&&d.push(_);if(d.length===0){alert("no selected file is *.HEIC");return}q(h,!0),q(f,K(d.length));for(const _ of d)t({blob:_,toType:`image/${v(n)}`,quality:1}).then(s=>{const p=_.name.replace(/heic/gi,v(n));v(o).push(new File([s],p))}).catch(s=>{alert("error, kialts"),console.log(s)})};var i=ca(),m=x(ae(i),2);m.__change=[ia];var l=x(m,2);{var c=d=>{},u=d=>{var _=ua(),s=C(_),p=C(s);Ze(p,21,()=>v(r),Ke,(L,H)=>{var N=sa(),F=C(N),P=C(F,!0);w(F);var B=x(F,2),z=C(B);w(B),w(N),te(J=>{Y(P,v(H).name),Y(z,`${J??""} MB`)},[()=>(v(H).size/1e3/1e3).toPrecision(2)]),M(L,N)}),w(p),w(s);var k=x(s,2),E=C(k),y=x(C(E),2),O=C(y);O.value=(O.__value="png")==null?"":"png";var R=x(O);R.value=(R.__value="jpeg")==null?"":"jpeg",w(y),w(E);var A=x(E,2);A.__click=b;var G=x(A,2);{var X=L=>{var H=va(),N=ae(H),F=C(N);w(N);var P=x(N,2),B=C(P);w(P);var z=x(P,2);{var J=S=>{var W=oa();M(S,W)},ge=S=>{var W=fa(),me=x(ae(W),2);me.__click=[la,o],M(S,W)};Q(z,S=>{v(g)?S(J):S(ge,!1)})}te(()=>{Y(F,`Converting ${v(f)??""} .heic images to .${v(n)??""}`),Y(B,`${v(o).length??""} / ${v(f)??""}`)}),M(L,H)};Q(G,L=>{v(h)&&L(X)})}w(k),w(_),te(()=>{y.disabled=v(g),A.disabled=v(g)}),ra(y,()=>v(n),L=>q(n,L)),M(d,_)};Q(l,d=>{!v(r)||v(r).length===0?d(c):d(u,!1)})}aa(m,()=>v(r),d=>q(r,d)),M(e,i),We()}Ge(["change","click"]);export{ma as component};
